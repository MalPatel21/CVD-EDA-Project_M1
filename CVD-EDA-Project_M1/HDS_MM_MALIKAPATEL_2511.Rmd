---
title: "CVD Analysis"
author: "mp2242@ice.cam.ac.uk"
output: 
  rmdformats::readthedown:
bibliography: https://raw.githubusercontent.com/MalPatel21/CVD-EDA-Project_M1/refs/heads/main/CVD-EDA-Project_M1/bibliography/references.bib
csl: https://raw.githubusercontent.com/MalPatel21/CVD-EDA-Project_M1/refs/heads/main/CVD-EDA-Project_M1/bibliography/ieee.csl
               
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

if(!require(tidyverse)) install.packages("tidyverse", repos = "http://cran.us.r-project.org")
if(!require(knitr)) install.packages("knitr", repos = "http://cran.us.r-project.org")
if(!require(DT)) install.packages("knitr", repos = "http://cran.us.r-project.org")
if(!require(car)) install.packages("car")
if(!require(skimr)) install.packages("skimr")
if(!require(pROC)) install.packages("pROC")
if (!require(tibble)) install.packages("tibble")

library(readr)
library(skimr)
library(dplyr)
library(pROC)
library(ggplot2)
library(broom)
library(tidyverse)
library(knitr)
library(DT)
library(car)
library(tibble)
library(tableone)
```

# Coversheet

![coversheet_pg1](https://raw.githubusercontent.com/MalPatel21/CVD-EDA-Project_M1/refs/heads/main/CVD-EDA-Project_M1/coversheet/coversheet_pg1.png)
![coversheet_pg2](https://raw.githubusercontent.com/MalPatel21/CVD-EDA-Project_M1/refs/heads/main/CVD-EDA-Project_M1/coversheet/coversheet_pg2.png) 
![coversheet_pg3](https://raw.githubusercontent.com/MalPatel21/CVD-EDA-Project_M1/refs/heads/main/CVD-EDA-Project_M1/coversheet/coversheet_pg3.png) 
![coversheet_pg4](https://raw.githubusercontent.com/MalPatel21/CVD-EDA-Project_M1/refs/heads/main/CVD-EDA-Project_M1/coversheet/coversheet_pg4.png) 

# Abstract 

Cardiovascular disease (CVD) continues to be the leading cause of death globally. It encompasses conditions such as coronary heart disease, stroke, and heart failure. Multiple risk factors for CVD, such as age, cholesterol, glucose, blood pressure, and gender, have been established; but there is less known about their effects in combination and the role of pulse pressure, an indicator of arterial stiffness. This study used an open-source dataset consisting of 70,000 adult patients and 13 features based on an individual's demographics, behavior, and medical information. It aimed to evaluate the influence of age, gender, cholesterol level, glucose level, and pulse pressure on CVD risk. Data preprocessing involved removing implausible values, converting numeric codes to categorical values, and deriving pulse pressure from systolic and diastolic blood pressures. At an individual level, exploratory visualizations showed trends in the occurrence of CVD across predictor categories. A multivariable logistic regression assessed the associations of these variables in conjunction with CVD. Age, elevated pulse pressure, and high cholesterol have been observed as significant positive predictors, with well above normal cholesterol showing the highest linkage. Glucose levels showed differing results, with above normal levels increasing risk and well above normal levels showing a reduced risk. Gender was revealed to be statistically insignificant. A receiver operating characteristic curve was used to measure model performance, and it showed adequate discriminatory ability (AUC = 0.75). These findings underscore the combined effect of risk factors, particularly the significant roles of increasing age, elevated pulse pressure, and high cholesterol in CVD risk. Overall, this study supports the complex nature of CVD, and shows how clinical and demographic data may be used to identify those who are at higher risk, allowing for earlier warning and intervention.


# Introduction
The term cardiovascular disease (CVD) is used to describe the wide array of diseases that impact the heart and blood vessels [@gaidai2023global]. Cardiovascular disease persists as the leading cause of death globally, responsible for approximately 32% or 19.8 million deaths in 2022 [@who2025cvd]. CVD encompasses a myriad of conditions, including cerebrovascular disease (stroke), hypertension (high blood pressure), vascular diseases, peripheral artery disease, and other heart-related diseases, including heart failure and coronary heart disease (heart attack) [@gaidai2023global, @gladwell2023traditional].

Numerous epidemiological studies have determined various established risk factors that increase the probability of developing CVD. Some of these factors include increasing age, hypertension, smoking, high cholesterol, obesity, diabetes, gender, and alcohol consumption [@nhs2025cvd]. These factors can aggravate CVD through a myriad of pathophysiological processes. To illustrate, elevated cholesterol contributes to plaque buildup in arterial walls, thereby increasing the risk of atherosclerotic cardiovascular disease (ASCVD) [@lee2019cholesterol]. Hypertensive individuals experience excessive stress on their arterial walls, which can damage the vessel lining and create microtears, leading over time to plaque formation and an increased risk of ASCVD [@aha2025hbp].

To further explore these relationships, the current analysis utilizes an open-source cardiovascular dataset (from Kaggle) containing information from 70,000 adult patients [@Ulianova2018cvd, @Torabi2018cvd]. The dataset includes 13 variables describing each individual’s demographic, behavioral, and clinical characteristics. Each variable is classified into one of three input types: objective, examination, or subjective. Objective inputs refer to factual demographic data, examination inputs derive from medical assessments, and subjective inputs are self-reported by the patient. Examination refers to the information acquired from the outcomes of a medical exam. Subjective information is the data provided by the patient.

The 13 columns of the dataset are described below, detailing the specific feature captured by each variable and its input type.

[Figure 1.0]

|Column Name   | Description                                |Measurement                                     |Input Type       
|--------------|--------------------------------------------|------------------------------------------------|----------
|ID            | Unique identifier for each individual      |                                                |
|Age           | Individual’s age                           |Days                                            |Objective
|Weight        | Individual’s weight                        |Kg                                              |Objective
|Gender        | Individuals Gender                         |1 = Women and 2 = Man                           |Objective
|ap_hi         | Systolic blood pressure                    |Integer (mmHg)                                  |Examination
|ap_lo         | Diastolic blood pressure                   |Integer (mmHg)                                  |Examination
|Cholesterol   | Categorical cholesterol level              |1: Normal, 2: Above normal, 3: Well above normal|Examination
|Gluc          | Categorical Glucose level                  |1: Normal, 2: Above normal, 3: Well above normal|Examination
|Smoke         | Whether an individual smokes               |1 = Yes and 0 = No                              |Subjective
|Alco          | Whether an individual consumes alcohol     |1 = Yes and 0 = No                              |Subjective
|Active        | Whether an individual is active            |1 = Yes and 0 = No                              |Subjective
|Cardio        | Presence/Absence of Cardiovascular disease |1 = Yes and 0 = No                              |

While many CVD studies have explored these risk factors independently, fewer have examined how combinations of these factors interact to influence the development of CVD. An even smaller number have incorporated pulse pressure as a contributing variable. Understanding the significance that these risks pose in combination enhances the ability to identify individuals who are at greater risk for CVD. Particularly, pulse pressure, defined as the difference between systolic and diastolic blood pressure [@homan2018physiology], is indicative of increased arterial stiffness; however, there are instances where elevated pulse pressure can contribute to CVD [@o1999pulse]. Examining pulse pressure in conjunction with other proven indicators may not only provide a more thorough picture of cardiovascular risk profiles but also allow for more targeted preventative interventions. 

This study aims to understand how various factors, including gender, age, cholesterol level, glucose level, and pulse pressure, influence the likelihood of developing cardiovascular disease amongst the adult population. These variables were selected because they have been consistently associated with cardiovascular risk in epidemiological studies. The current analysis focuses on these selected variables to evaluate their contribution to CVD risk through descriptive statistics, correlation analysis, and predictive modeling.

To achieve this objective, the study employed a structured analytical approach encompassing several stages of data preprocessing and analysis. These steps included data cleaning (e.g., removal of implausible values), derivation of new variables such as pulse pressure, data visualization, and logistic regression modeling.


# Method
The first steps in this analysis involved acquiring and importing the dataset. As aforementioned, the data were downloaded from the open-source CVD dataset on Kaggle. Consequently, no data access permissions or ethical approvals were needed. The data was first uploaded to a GitHub repository to increase accessibility and aid in reproducibility. In RStudio, an R Markdown file was created to conduct the analysis. The `readr` package was then used to import the dataset from the GitHub URL using the `read_delim()` function with the semicolon (“;”) set as the delimiter. The dataset was then stored in a data frame titled `ddata`.

Following data acquisition, an initial exploratory analysis was conducted to examine the structure and contents of the dataset, including its values, missing values (NaNs), data distribution, potential outliers, and other key characteristics. The `DT` package was used to create an interactive data table displaying the first 1000 rows. This allowed for a quick inspection of its initial contents while providing an overview of the dataset. Next, the package `skimr` was used to generate a data summary of the CVD dataset. The summary included the number of rows, columns, and column type frequency. The summary also reported the count of missing values. In this dataset, all columns exhibited 100% completeness; therefore, no removal or imputation of missing values was necessary.

Following initial data exploration, a feature engineering step was applied in which a new variable, pulse pressure (pp), was derived by subtracting the column ap_lo (diastolic blood pressure) from ap_hi (systolic blood pressure). Age was then converted from days to years (rounded down)  to improve formatting and interpretability for subsequent analysis.

Further inspection of the data summary output generated by `skimr` revealed that several variables contained a range of values that fell out of the clinically expected numbers. Specifically, weight had a minimum of 10 kg, height ranged from 55 cm to 250 cm, ap_hi had values between –150 mmHg and 16,020 mmHg, and ap_lo ranged from –70 mmHg to 110,000 mmHg. As these values are implausible given the dataset and aims of this project, they need to be removed from the analysis. 

To remove these values, clinically plausible ranges were established for each variable and used to filter the dataset. For the feature weight, rows were retained where an individual's weight was 40 kg or above. Individuals who had a height of at least 150 cm but no greater than 210 cm were also retained. Notably, ap_hi and ap_lo displayed the widest range of unrealistic values. Individuals with a systolic blood pressure of less than 90 mmHg are considered to have low blood pressure [@nhs2025lbp]; less than 120 mmHg is classified as normal; 120–129 mmHg is considered elevated; 130–139 mmHg is High Blood Pressure Stage 1; 140 mmHg or higher is Stage 2; and anything above 180 mmHg is considered a Hypertensive Crisis. For diastolic blood pressure, less than 60 mmHg is considered low; 80 mmHg or lower is considered normal or elevated (depending on systolic pressure); 80–89 mmHg is Stage 1; 90 mmHg or higher is Stage 2; and anything exceeding 120 mmHg is a Hypertensive Crisis. Based on these clinical guidelines, a realistic range for ap_hi was defined as 80–200 mmHg and for ap_lo as 50–130 mmHg [@nhlbi2025hbp]. Values falling outside of these ranges were omitted. The data was then reexamined using the interactive data table and the summary output generated by `skimr` to ensure that all implausible values had been successfully removed and that the dataset met the established quality criteria.

The filtered data is stored in the dataframe `ddata_clean`. The `mutate()` function is then used to convert several variables from numeric codes into categorical values. Specifically, `mutate()` was applied to the variables gender, cardio, cholesterol, and gluc to replace the numeric values with descriptive factor labels (see Figure 1.0 for original numeric codes and their corresponding categorical labels). This conversion is important because R may mistakenly treat these numeric codes as continuous/ordinal values, creating misleading results for statistical analysis, data visualisations, and summaries. 

Exploratory visualisations were generated using `ggplot2`to examine the distributions and relationships of variables. Bar charts were created for categorical variables (gender, cholesterol, glucose) to visualise counts by CVD status. Histograms were created for continuous variables (age, pulse pressure) to assess distributions. A scatterplot was also created for systolic versus diastolic blood pressure to examine their relationship. 

```{r example_code, eval = FALSE}
# Example exploratory plot: Bar chart of CVD by gender
ggplot(ddata_clean, aes(x = gender, fill = cardio)) +
  geom_bar(position = "dodge") +
  labs(title = "Cardiovascular Disease by Gender",
       x = "Gender",
       y = "Count",
       fill = "CVD Status") +
  scale_fill_manual(values = c("#ad820c","#5e0921")) +
  theme_minimal()
```

Similar plots were generated for the other variables to support understanding of the dataset prior to modelling.

The exploratory plots illustrate baseline patterns within the dataset and highlight variables that may be relevant in predicting CVD (refer to Figure 2.0 - 7.0). However, because these relationships are examined in isolation, they do not account for confounding or interactions between predictors. To address this, the analysis proceeds with a multivariable logistic regression model, allowing for the joint evaluation of age, gender, cholesterol, glucose, and pulse pressure in explaining the likelihood of CVD.

These factors were included in a multivariable logistic regression model to predict the binary outcome cardio using the `glm()` function. The model was assessed for potential multicollinearity using variance inflation factors (VIFs) calculated with the `vif()` function from the `car` package, which quantify correlations between predictors. Then the model coefficients were extracted using `summary()` and tidied into a structured data frame for reporting. Adjusted odds ratios with 95% confidence intervals were calculated using the `broom::tidy()` function and visualised with `ggplot2` to provide an intuitive representation of each predictor’s relative contribution to CVD risk. To evaluate the predictive performance of the logistic regression model, predicted probabilities were generated using `predict()` and a receiver operating characteristic (ROC) curve was plotted using the `pROC` package. The ROC curve visualises the model’s ability to distinguish between individuals with and without CVD.

In summary, the analyses highlight age, pulse pressure, and cholesterol as the strongest predictors of CVD in this dataset. The odds ratio plot and ROC curve provide complementary views of individual effects and overall model performance, establishing a clear basis for interpreting risk factors and guiding further discussion.

# Results


```{r loaddata, echo=FALSE}

file.url <- "https://raw.githubusercontent.com/MalPatel21/CVD-EDA-Project_M1/refs/heads/main/CVD-EDA-Project_M1/data/cardio_train.csv"

ddata <- read_delim(file.url, delim = ";", show_col_types = FALSE)

```

## Initial Data Overview

``` {r data_overview, echo = FALSE}

DT::datatable(        # Interactive Data Table
  head(ddata, 1000),  # subset of data
  extensions = 'Buttons',
  options = list(
    paging = TRUE,
    searching = TRUE,
    fixedColumns = TRUE,
    autoWidth = TRUE,
    ordering = TRUE,
    dom = 'Bfrtip',
    buttons = c('copy', 'excel')
  ),
  class = "display nowrap"
)

skim(ddata) # Provides and overview of the data

```

## Cleaned Dataset
``` {r data_cleaning, echo = FALSE}

ddata <- ddata %>%
  
  mutate(
    pp = ap_hi - ap_lo,      # Calculate pulse pressure
    age = floor(age / 365)   # Convert age from days to years
  ) %>%
  
  # Filter out implausible or extreme values
  filter(
    weight >= 40,                     # Weight >= 40 kg
    height >= 150 & height <= 210,    # Height between 150–210 cm
    ap_hi >= 80 & ap_hi <= 200,       # Systolic BP within plausible range
    ap_lo >= 50 & ap_lo <= 130,       # Diastolic BP within plausible range
    age >= 39,                        # Adults aged 39+
    pp > 0                            # Pulse pressure must be positive
  )

# Display first 1000 rows in a searchable, exportable datatable
DT::datatable(
  head(ddata, 1000),
  extensions = 'Buttons',
  options = list(
    paging = TRUE,
    searching = TRUE,
    fixedColumns = TRUE,
    autoWidth = TRUE,
    ordering = TRUE,
    dom = 'Bfrtip',
    buttons = c('copy', 'excel')
  ),
  class = "display nowrap"
)

# Summary of cleaned data
skim(ddata)

```

```{r testT, echo = FALSE}

# Create a clean dataset with factors for plotting and modeling
ddata_clean <- ddata %>%
  mutate(
    gender = factor(gender, labels = c("Female", "Male")),                             # 1 = Female, 2 = Male
    cardio = factor(cardio, labels = c("No CVD", "CVD")),                              # 0 = No CVD, 1 = CVD
    cholesterol = factor(cholesterol, labels = c("Normal", "Above Normal", "Well Above Normal")),  # Cholesterol levels
    gluc = factor(gluc, labels = c("Normal", "Above Normal", "Well Above Normal"))     # Glucose levels
  )

```

## Exploratory Data Analysis

Figure 2.0 displays the distribution of individuals with/without CVD, separated by gender. The plot shows that more women are represented overall, with approximately 2% more females not exhibiting CVD (Figure 2.1). In comparison, men had a lower overall count, with around 0.2% more men having CVD than not (Figure 2.1).  From these figures, women are slightly less at risk of developing CVD.
``` {r grouped_bar_chart_gender, echo = FALSE}

# Grouped bar chart showing CVD counts by gender
ggplot(ddata_clean, aes(x = gender, fill = cardio)) +
  geom_bar(position = "dodge") +  # Place bars side by side for comparison
  labs(
    title = "Cardiovascular Disease by Gender [Figure 2.0]",
    x = "Gender",
    y = "Count",
    fill = "CVD Status"
  ) +
  scale_fill_manual(values = c("#ad820c", "#5e0921")) +
  theme_minimal()

# Table summarizing CVD and Non-CVD counts and percentages by gender
ddata_clean %>%
  count(gender, cardio) %>%              # Count observations for each gender–CVD combination
  group_by(gender) %>%                   # Calculate percentages within each gender
  mutate(percentage = paste0(round(n / sum(n) * 100, 1), "%")) %>%
  select(gender, cardio, n, percentage) %>%
  ungroup() %>%                          # Remove grouping for clean output
  kable(
    col.names = c("Gender", "CVD Status", "Count", "Percentage"),
    caption = "Proportion of CVD by Gender [Figure 2.1]"
  )

```

Figure 3.0 displays the distribution of individuals with/without CVD, separated by cholesterol level categories. Normal cholesterol levels have the largest number of individuals represented within this dataset. Additionally, 13% more individuals do not have CVD compared to those who do at a normal cholesterol level. There is a significantly smaller number of people with above normal and well above normal cholesterol. At these levels, a greater percentage of individuals have CVD. 19% more individuals have CVD at an above normal level, and 52.5% at a well above normal level. These visualizations suggest that within this dataset, higher cholesterol levels are associated with a higher proportion of individuals with cardiovascular disease.

``` {r grouped_bar_chart_chol, echo = FALSE}

# Grouped bar chart showing CVD counts by cholesterol level
ggplot(ddata_clean, aes(x = cholesterol, fill = cardio)) +
  geom_bar(position = "dodge") +  # Place bars side by side for comparison
  labs(
    title = "Cardiovascular Disease by Cholesterol Level [Figure 3.0]",
    x = "Cholesterol",
    y = "Count",
    fill = "CVD Status"
  ) +
  scale_fill_manual(values = c("#ad820c", "#5e0921")) +
  theme_minimal()

# Table summarizing CVD and Non-CVD counts and percentages by cholesterol level
ddata_clean %>%
  count(cholesterol, cardio) %>%              # Count observations for each cholesterol–CVD combination
  group_by(cholesterol) %>%                   # Calculate percentages within each cholesterol category
  mutate(percentage = paste0(round(n / sum(n) * 100, 1), "%")) %>%
  select(cholesterol, cardio, n, percentage) %>%
  ungroup() %>%                                # Remove grouping for clean output
  kable(
    col.names = c("Cholesterol", "CVD Status", "Count", "Percentage"),
    caption = "Proportion of CVD by Cholesterol [Figure 3.1]"
  )
```

Figure 4.0 displays the distribution of individuals with/without CVD, separated by glucose level categories. Normal glucose levels represent the majority of this dataset. At this level, 5% more individuals do not have CVD compared to those who do. Above normal and well above normal glucose levels make up a smaller portion of the dataset. At an above normal level, 17% more individuals have CVD, and 22.8% at a well above normal level. Within this dataset, the figures indicate that higher glucose levels are associated with a greater proportion of individuals with CVD compared to those without CVD.

``` {r grouped_bar_chart_gluc, echo = FALSE}

# Grouped bar chart showing CVD counts by glucose level
ggplot(ddata_clean, aes(x = gluc, fill = cardio)) +
  geom_bar(position = "dodge") +  # Place bars side by side for comparison
  labs(
    title = "Cardiovascular Disease by Glucose Level [Figure 4.0]",
    x = "Glucose",
    y = "Count",
    fill = "CVD Status"
  ) +
  scale_fill_manual(values = c("#ad820c", "#5e0921")) +
  theme_minimal()

# Table summarizing CVD and Non-CVD counts and percentages by glucose level
ddata_clean %>%
  count(gluc, cardio) %>%              # Count observations for each glucose–CVD combination
  group_by(gluc) %>%                   # Calculate percentages within each glucose category
  mutate(percentage = paste0(round(n / sum(n) * 100, 1), "%")) %>%
  select(gluc, cardio, n, percentage) %>%
  ungroup() %>%                        # Remove grouping for clean output
  kable(
    col.names = c("Glucose", "CVD Status", "Count", "Percentage"),
    caption = "Proportion of CVD by Glucose [Figure 4.1]"
  )
```

Figure 5.0  shows the distribution of CVD status by age. Individuals aged 50 and below generally do not have CVD, with few who do. Between 50 - 55, the number of people who have CVD increases, with it peaking at 51- 52. Overall, there is a similar number of people with and without CVD. In the range of individuals aged above 55, the proportion of those who have CVD compared to those who don’t increases, while the proportion of individuals who don’t have CVD begins to rapidly decline. The trend suggests that as age increases, the likelihood of CVD appearing increases.

``` {r hist_age, echo = FALSE}

# Histogram showing the age distribution for individuals with and without CVD
ggplot(ddata_clean, aes(x = age, fill = cardio)) +
  geom_histogram(position = "identity", alpha = 0.7, bins = 25) +  # Overlapping histograms for comparison
  labs(
    title = "Age Distribution by Cardiovascular Disease Status [Figure 5.0]",
    x = "Age (years)",
    y = "Count",
    fill = "CVD Status"
  ) +
  scale_fill_manual(values = c("#ad820c", "#5e0921")) +
  theme_minimal()
```

Figure 6.0 displays a scatter plot, plotting the relationship between systolic and diastolic blood pressure by CVD status. The scatter plot indicates a positive relationship between systolic and diastolic blood pressure. Both individuals with and without CVD exhibit overlapping blood pressure values; however, CVD cases appear more concentrated at higher blood pressure values. The strong correlation between ap_hi and ap_lo also supports the decision to model blood pressure using pulse pressure, a derived variable that captures arterial pressure load while reducing redundancy between systolic and diastolic measures.

``` {r scatter_syst_diast, echo = FALSE}

# Scatter plot showing the relationship between systolic and diastolic blood pressure by CVD status
ggplot(ddata_clean, aes(x = ap_hi, y = ap_lo, color = cardio)) +
  geom_point(alpha = 0.6, size = 2.2) +  # Semi-transparent points for clearer overlap
  labs(
    title = "Relationship Between Systolic and Diastolic Blood Pressure by CVD Status [Figure 6.0]",
    x = "Systolic Blood Pressure (ap_hi)",
    y = "Diastolic Blood Pressure (ap_lo)",
    color = "CVD Status"
  ) +
  scale_color_manual(values = c("#ad820c", "#5e0921")) +
  theme_minimal()
```

Figure 7.0 displays the pulse pressure distribution by CVD status using a histogram. The number of individuals without CVD increased and reached its highest point at a pulse pressure of 35, then declined sharply as pulse pressure continued to rise. Individuals who had CVD exhibited the same pattern; however, after a pulse pressure of 35, the number of individuals who had CVD surpassed those who did not. This suggests that as pulse pressure increases, the proportion of individuals who have CVD also increases.

``` {r hist_pp, echo = FALSE}

# Histogram showing the distribution of pulse pressure for individuals with and without CVD
ggplot(ddata_clean, aes(x = pp, fill = cardio)) +
  geom_histogram(position = "identity", alpha = 0.7, bins = 25) +  # Overlapping histograms for comparison
  labs(
    title = "Pulse Pressure Distribution by Cardiovascular Disease Status [Figure 7.0]",
    x = "Pulse Pressure",
    y = "Count",
    fill = "CVD Status"
  ) +
  scale_fill_manual(values = c("#ad820c", "#5e0921")) +
  theme_minimal()
```

## Final Results

### Cohort characteristic table

``` {r cohort_characteristic, echo = FALSE}

# Define variables
vars <- c("age", "pp", "gender", "cholesterol", "gluc")
factor_vars <- c("gender", "cholesterol", "gluc")

# Create TableOne object stratified by CVD status
tab1 <- CreateTableOne(vars = vars, strata = "cardio", data = ddata_clean, factorVars = factor_vars)

# Print table to data frame
tab1_df <- as.data.frame(print(tab1, showAllLevels = TRUE, quote = FALSE, noSpaces = TRUE))


```

### Check for collinearity

Figure 8.0 displays the VIF values for each variable. All values were close to 1, indicating minimal to no multicollinearity between the predictors. These results confirm that multicollinearity is not a concern, allowing for a reliable interpretation of the logistic regression coefficients.
``` {r collinearity_check, echo = FALSE}

# Logistic regression model predicting CVD using age, gender, pulse pressure, cholesterol, and glucose
model <- glm(cardio ~ age + gender + pp + cholesterol + gluc, 
             data = ddata_clean, family = binomial)

# Calculate Variance Inflation Factors (VIF) to assess multicollinearity
vif_values <- vif(model)

# Convert VIF matrix to a data frame for table display
vif_df <- as.data.frame(vif_values) %>%
  rownames_to_column("Variable") %>%              # Move variable names into a column
  mutate(across(where(is.numeric), ~ round(., 5)))  # Round numeric values to 5 decimals

# Display VIF table
kable(vif_df, caption = "Variance Inflation Factors [Figure 8.0]")
```

### Coefficients Matrix

The `summary()` output provides coefficient estimates, standard errors, z-values, and p-values for each predictor in the logistic regression model (Figure 8.1). Age and pulse pressure were both associated with higher odds of CVD (p < 0.001). Cholesterol levels also showed significant effects, with the Above Normal and Well Above Normal categories increasing the likelihood of CVD, with the Well Above Normal group showing the strongest association. Glucose levels showed mixed results. The Above Normal category increased CVD odds. The Well Above Normal category was associated with reduced odds. Gender was not statistically significant (p = 0.085). Subsequently, there is no strong evidence of a gender difference impacting CVD risk within this dataset.

``` {r LR_summary, echo = FALSE}

# Extract coefficient matrix from the logistic regression model
coef_mat <- summary(model)$coefficients

# Convert coefficients to a tidy data frame
coef_df <- as.data.frame(coef_mat) %>%
  tibble::rownames_to_column(var = "Variable") %>%  # Move row names into a column
  dplyr::rename(
    Estimate  = `Estimate`,
    Std_Error = `Std. Error`,
    Z_value   = `z value`,
    P_value   = `Pr(>|z|)`
  ) %>%
  dplyr::select(Variable, Estimate, Std_Error, Z_value, P_value)

# Display coefficient table
kable(coef_df, caption = "GLM Coefficients [Figure 8.1]")
```
### Final Visualisations

To further illustrate these findings, an odds ratio plot was generated to visually summarise the strength and direction of each predictor’s association with CVD (Figure 8.2). This plot displays the adjusted odds ratios and their respective 95% confidence intervals. This allows for an intuitive comparison of the performance of each predictor in terms of contributing to CVD. Predictors that do not have confidence intervals crossing 1 indicate a statistically significant association. These results are consistent with the output from summary(). They reinforce the notion that gender (male) has little statistical significance, while other predictors, such as cholesterol Well Above Normal, are strong predictors.

``` {r odd_ratios, echo = FALSE}

# Tidy the logistic regression model and calculate exponentiated estimates (odds ratios) with confidence intervals
tidy_model <- broom::tidy(model, conf.int = TRUE, exponentiate = TRUE)

# Plot adjusted odds ratios with 95% confidence intervals for each predictor (excluding intercept)
ggplot(tidy_model[-1,], aes(x = term, y = estimate, ymin = conf.low, ymax = conf.high)) +
  geom_pointrange(
    color = "#5e0921"  # Color for confidence interval lines
  ) +
  geom_point(
    color = "#ad820c"  # Color for point estimates
    # Point size is left at default, smaller than typical default for clarity
  ) +
  coord_flip() +  # Flip coordinates for horizontal readability
  labs(
    x = "Predictor",
    y = "Odds Ratio (95% CI)",
    title = "Adjusted Odds Ratios for CVD [Figure 8.2]"
  ) +
  theme_minimal()
```

To assess the overall predictive performance of the logistic regression model, a receiver operating characteristic (ROC) curve was generated. This curve shows how well the model distinguishes between individuals with and without CVD, complementing the insights from the odds ratio plot. The ROC curve demonstrates that the model is able to perform at a relatively high level, with an area under the curve (AUC) of 0.7498. It suggests that the model has a 75% chance of correctly ranking a random individual with CVD higher than one without CVD. The model has acceptable discernibility; however, there is room for improvement.

``` {r roc_curve, echo = FALSE}

# Generate predicted probabilities from the logistic regression model
pred_probs <- predict(model, type = "response")

# Create ROC object to evaluate model performance
roc_obj <- suppressMessages(roc(ddata_clean$cardio, pred_probs))

# Plot ROC curve
plot(
  roc_obj,
  col = "#5e0921",        # Line color
  lwd = 2,                 # Line width
  main = "ROC Curve for Logistic Regression Model [Figure 8.3]"
)
abline(a = 0, b = 1, lty = 2, col = "gray")  # Diagonal reference line for random classifier

# Display the area under the curve (AUC)
auc(roc_obj)
```

# Discusion

This study aimed to understand how various factors—including gender, age, cholesterol level, glucose level, and pulse pressure—influence the likelihood of developing cardiovascular disease among adults. As expected, our findings suggest that age, elevated pulse pressure, and elevated cholesterol levels were linked to a higher risk of developing CVD. Elevated pulse pressure is likely indicative of arterial stiffness, an established contributor to CVD [@who2025cvd]. Increased cholesterol contributes to atherosclerotic plaque formation, consistent with prior studies [@lee2019cholesterol].

Contrary to expectations, gender proved to be an insignificant predictor within this dataset. This may be due to the proportion of males to females or other predictors distorting the relationship between the independent/dependent variables. These findings contradict what many studies have established, with CVD risk being greater amongst males [@mikkola2013sex]. Glucose showed mixed results, with Above Normal being associated with higher odds of CVD and Well Above Normal being associated with lower odds. These differences could be influenced by the sample composition and/or a myriad of external unaccounted factors, such as a patient's genetics, lifestyle choices, and medication use.

These findings emphasize the importance of monitoring pulse pressure and cholesterol as risk factors. It also suggests that further research is needed to understand the role of glucose levels and gender in CVD risk. 

Limitations of this study include the missing data source, the cross-sectional data use, cholesterol and glucose using categorical values, and measurement/input errors. Strengths include meticulous data cleaning, comprehensive exploratory data analysis, and multivariable analysis. Suggestions for further development include using longitudinal data, incorporating additional clinical features, and integrating lifestyle factors to improve predictive accuracy and validate these findings in larger populations.


# Conclusion

This study identified key predictors for CVD, showing that increasing age, elevated blood pressure, and higher cholesterol are positively associated with its development. Unexpectedly, increased glucose levels showed an inverse relationship, and gender proved to be an insignificant predictor for CVD risk. These conclusions were derived from the summary() function (Figure 8.1) and the odds ratio graph (Figure 8.2). The multivariable logistic regression model displayed moderate discrimination in distinguishing between patients with and without CVD, supported by the ROC AUC score of 0.7498. Collectively, these findings underpin the multifactorial nature of CVD risk, the value of analysing these factors in conjunction, and the importance of utilising data to identify risk factors for prevention. Despite constraints from data entry errors and the use of categorical variables (glucose and cholesterol), the results provide a clear foundation for deeper exploration.


# References
